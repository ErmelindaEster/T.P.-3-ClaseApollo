<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Listado de Alumnos</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body { background:#f7f9fc; }
    header.hero{
      position:relative; overflow:hidden;
      border-bottom-left-radius:20px; border-bottom-right-radius:20px;
      box-shadow:0 6px 18px rgba(0,0,0,.08);
    }
    header.hero img{
      width:100%; height:320px; object-fit:cover; filter:brightness(.8);
      display:block;
    }
    header.hero .overlay{
      position:absolute; inset:0; display:grid; place-items:center;
    }
    .btn-brand{ background:#0d6efd; border:none; }
    .btn-brand:hover{ background:#0b5ed7; }
    .card{ border:0; border-radius:18px; box-shadow:0 10px 24px rgba(0,0,0,.06); }
    .card-img-top{ border-top-left-radius:18px; border-top-right-radius:18px; height:180px; object-fit:cover; }
    footer{ background:#0f172a; color:#e2e8f0; }
  </style>
</head>

<body>
  <!-- NAV -->
  <nav class="navbar navbar-light bg-light sticky-top shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="#">ðŸŽ“ Alumnos</a>
      <a class="btn btn-outline-primary" href="#video">Video</a>
    </div>
  </nav>

  <!-- HERO: imagen + botÃ³n ENTRAR -->
  <header class="hero">
    <img src="https://images.unsplash.com/photo-1513258496099-48168024aec0?q=80&w=1600&auto=format&fit=crop" alt="Encabezado">
    <div class="overlay">
      <a href="#lista" class="btn btn-brand btn-lg text-white px-4">Entrar</a>
    </div>
  </header>

  <!-- CUERPO -->
  <main class="container my-5" id="lista">
    <!-- Estado / mensajes -->
    <div id="estado" class="alert alert-info text-center" role="status" aria-live="polite">
      Cargando datosâ€¦
    </div>

    <!-- Grid de tarjetas -->
    <div id="resultado" class="row g-4">
      <!-- JS insertarÃ¡ aquÃ­ las tarjetas -->
    </div>

    <!-- VIDEO -->
    <section id="video" class="mt-5">
      <h2 class="h4 mb-3 text-center">ðŸŽ¬ Video del Proyecto (Alumnos)</h2>

      <div class="ratio ratio-16x9 shadow rounded-3">
        <!-- ðŸŽ¥ Video de YouTube actualizado -->
        <iframe
          src="https://www.youtube.com/embed/yjAT2ob76NA"
          title="Video del Proyecto Alumnos"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          allowfullscreen>
        </iframe>
      </div>
    </section>
  </main>

  <!-- PIE -->
  <footer class="py-4 mt-5">
    <div class="container text-center">
      <small>Hecho por <strong>Delgado Ester</strong> 2025.</small>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Supabase + LÃ³gica -->
  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm';

    // === Credenciales Supabase ===
    const SUPABASE_URL = 'https://ykgnmdhtiymovgeapaif.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlrZ25tZGh0aXltb3ZnZWFwYWlmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA4NTU1OTcsImV4cCI6MjA3NjQzMTU5N30.j472eqejn8GIhGRyOApsLY7xU70fkkQrl9IhX_44tr0';

    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const estadoEl = document.getElementById('estado');
    const resultadoEl = document.getElementById('resultado');

    function mostrarEstado(msg, tipo='info'){
      estadoEl.className = `alert alert-${tipo} text-center`;
      estadoEl.textContent = msg;
    }

    function crearTarjetaAlumno(fila){
      const col = document.createElement('div');
      col.className = 'col-12 col-sm-6 col-lg-4';

      const foto = fila.foto_url
        ? fila.foto_url
        : `https://picsum.photos/seed/alumno-${fila.id ?? Math.floor(Math.random()*9999)}/600/360`;

      const matriculado = fila.matriculado === true ? 'SÃ­' : (fila.matriculado === false ? 'No' : 'â€”');
      const fecha = fila.fecha_registro ? new Date(fila.fecha_registro).toLocaleString() : 'â€”';

      col.innerHTML = `
        <div class="card h-100">
          <img src="${foto}" class="card-img-top" alt="Foto de ${fila.nombre ?? 'Alumno'}">
          <div class="card-body">
            <h5 class="card-title mb-1">${fila.nombre ?? 'Sin nombre'}</h5>
            <p class="text-muted mb-3">ID: ${fila.id ?? 'â€”'}</p>
            <ul class="list-unstyled mb-0">
              <li><strong>Edad:</strong> ${fila.edad ?? 'â€”'}</li>
              <li><strong>Matriculado:</strong> ${matriculado}</li>
              <li><strong>Registro:</strong> ${fecha}</li>
            </ul>
          </div>
        </div>`;
      return col;
    }

    async function cargarAlumnos(){
      try{
        mostrarEstado('Cargando datos desde Supabaseâ€¦');
        resultadoEl.innerHTML = '';

        const { data, error } = await supabase
          .from('alumnos')
          .select('*')
          .order('id', { ascending: true });

        if(error) throw error;

        if(!data || data.length === 0){
          mostrarEstado('No hay registros para mostrar.', 'warning');
          return;
        }

        data.forEach(fila => resultadoEl.appendChild(crearTarjetaAlumno(fila)));
        mostrarEstado('Datos cargados correctamente âœ…', 'success');
      }catch(e){
        console.error(e);
        mostrarEstado('OcurriÃ³ un error al cargar los datos.', 'danger');
      }
    }

    document.addEventListener('DOMContentLoaded', cargarAlumnos);
  </script>
</body>
</html>

